<!DOCTYPE html>
<html>
<body>
    <button id="test" onclick="popUpInteract()">?</button>
    
    <div id="popup">
        <div id="scrollbox">
            <script>
                document.addEventListener('DOMContentLoaded', (event) => {
                    document.getElementById('send-button').addEventListener('click', getStockData);
            
                    async function getStockData() {
                        const userInput = document.getElementById('user-input').value.trim().toUpperCase();
                        const stockHistory = document.getElementById('stock-history');
            
                        // Display user's input
                        stockHistory.innerHTML += `<div>Symbol: ${userInput}</div>`;
            
                        try {
                            const response = await fetch(`https://stocktify.stu.nighthawkcodingsociety.com/api/stockdata?symbol=${userInput}`, {
                                method: 'GET',
                                mode: 'cors' // Add this line to enable CORS
                            });
            
                            const jsonData = await response.json();
            
                            // Extract meta data
                            const metaData = jsonData["Meta Data"];
                            const lastRefreshed = metaData["3. Last Refreshed"];
                            const dailyData = jsonData["Time Series (Daily)"][lastRefreshed];
            
                            stockHistory.innerHTML += `<div>Last Refreshed: ${lastRefreshed}</div>`;
                            stockHistory.innerHTML += `<div>Open: ${dailyData["1. open"]}</div>`;
                            stockHistory.innerHTML += `<div>High: ${dailyData["2. high"]}</div>`;
                            stockHistory.innerHTML += `<div>Low: ${dailyData["3. low"]}</div>`;
                            stockHistory.innerHTML += `<div>Close: ${dailyData["4. close"]}</div>`;
                            stockHistory.innerHTML += `<div>Volume: ${dailyData["6. volume"]}</div>`;
            
                        } catch (error) {
                            stockHistory.innerHTML += `<div>Error: ${error.message}</div>`;
                        }
                    }
                });
            </script>
        </div>
        <div id="searchbar">
            <input type="text" placeholder="Search by abbreviation" id="searchresult" style="width: 193px"/>
            <button id="searchbut">Search</button>
        </div>
    </div>
<style>
    #test {
        position: fixed;
        bottom: 10%;
        right: 10%;
        z-index: 9999;  
        padding: 5px;
        font-size: 25px;
        display:block;
        height: 50px;
        width: 50px;
        border-radius: 50%;
        background-color: #A5FF95 !important;
        color: #121212 !important;
    }
    #popup {
        position: fixed;
        bottom: 18%;
        right: 10%;
        z-index: 9999;  
        background-color: #000;
        border: 10px solid #a5ff95;
        width:300px;
        height:70%;
        border-radius: 10px;
    }
    #results {
        margin:5px;
        padding: 10px;
        background-color: #C8FFBF;
        border: 5px solid #4ebd3a;
        border-radius: 5px;
        color: #000;
    }
    #scrollbox{
        overflow:scroll;
        height:90%;
    }
    #searchbar {
        margin:5px;
        padding: 10px;
        background-color: #333333;
        border: 5px solid #4ebd3a;
        border-radius: 5px;
        color: #000;
        bottom: 0;
        position: absolute;
        width: 97%;
    }
</style>
</body>
</html>
<script>
    let popup = document.getElementById("popup");
    popup.setAttribute("hidden", "hidden");
    function popUpInteract() {
        let ishidden = popup.getAttribute("hidden");
        if (ishidden) {
            popup.removeAttribute("hidden");
         } else {
            popup.setAttribute("hidden", "hidden");
         }
    }
</script>
